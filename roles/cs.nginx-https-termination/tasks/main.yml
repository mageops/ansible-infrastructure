- name: Prepare effective configuration
  import_tasks: 000-facts.yml

- name: Setup filesystem structure
  import_tasks: 010-filesystem.yml

- name: Create filesystem structure
  import_tasks: 020-nginx.yml

- name: Install user-provided certificates
  import_tasks: 030-certificates-install.yml

- name: Bootstrap self-signed certificates if not provided
  import_tasks: 032-certificates-bootstrap.yml

- name: Setup automatically renewed ACME certificates
  import_tasks: 034-certificates-acme.yml

- name: Reload nginx immediately if config has changed on disk
  include_role: 
    name: cs.nginx
    tasks_from: 100-config-conditional-reload.yml
